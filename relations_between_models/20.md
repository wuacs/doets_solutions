Let $A, B$ be two L-structures and let $f$ be a function mapping the domain of A into that of B.

---
if for all atomic formulas $\phi$ and for all $\alpha$ A-assignments $A \models \phi[\alpha] \iff B \models \phi[f(\alpha)]$ then $A$ is embeddable in B. 

---

My proof goes like this:
lets create the substructure in B obtained by taking the image of $f$.
First let us prove that $C$ is indeed a substructure of $B$.

1. We want to prove $c^C=c^B$ but $c^C=f(c^A)$ and by the formula $\phi(x) \triangleq c=x$ that must be true in B whenever $x$ is $f(c^A)$ we get $f(c^A)=c^C=c^B$.
2. We want to prove that $g^B(c_1,...,c_n) \in C$. Let $z=g^A(f^{-1}(c_1),...,f^{-1}(c_n))$. Let $\phi$ be the formula $\phi(x_1,..,x_n,y) \triangleq y = g(x_1,...,x_n)$ which is true in B only if (by hypothesis) $y=f(z)$ i.e. when $g^B(c_1,..,c_n)=f(z)$.
3. We want to prove that $C \models R(c_1,..,c_n) \iff B \models R(c_1,..,c_n)$. This comes simply by deciding that R behaves the same on the same inputs in both C and B.

I wish to prove that $f$ is an isomorphism from $A$ to this substructure $C$

1. $f(c^A) = c^C$: this comes from the formula $\phi(x): x = c$. Since $c^C=c^B$ by the first point above we have that $B \models x = c[f(\alpha)]$ only if $\alpha(x)=c^A$ thus $f(c^A)=c^B=c^C$
2. $f(g^A(a_1,...,a_n)) = g^B(f(a_1),...,f(a_n))$: this comes from the fact that we can write the formula $\phi(x_1,...,x_n) \triangleq y = g(x_1,...,x_n)$ and it becomes like point 1 for reasoning. 
3. Same thing for relational symbols.
4. we also need to prove $f:A\mapsto B$ to be injective and surjective
	1. injectivity: $\phi(x, y) \triangleq x=y$ is implied by the $\impliedby$ direction
	2. surjectivity: comes from construction of the substructure.